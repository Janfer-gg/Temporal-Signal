png(file = paste0(filepath,"//","GC content.png"),width = 480*2,height = 480*2,res = 72*2)
print(p)
dev.off()
Full_length<-length(seq)
A_count<-letterFrequency(seq,"A")
A_percent<-paste0(round(A_count/Full_length*100,2),"%")
T_count<-letterFrequency(seq,"T")
T_percent<-paste0(round(T_count/Full_length*100,2),"%")
G_count<-letterFrequency(seq,"G")
G_percent<-paste0(round(G_count/Full_length*100,2),"%")
C_count<-letterFrequency(seq,"C")
C_percent<-paste0(round(C_count/Full_length*100,2),"%")
Count<-data.frame(A=A_count,T=T_count,G=G_count,C=C_count)
return(Count)
}
seq<-"TTACTTGGGTGTGGAGGCATGTGCCTATAATCCAAGGTACTCAGGAGGCTGAGGCATGAGAATTGCTTGAACCCGGGAGGTAGAGGTTGCAGTGAGCTGAGATTATGCCACTGCACTCCAGCCTGGATGACAGAGTGAGGCTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAGAAGTAGAATCATATGGTAATTCTGTGTTTAACTTTTTGAGGAACGCCAGACTCTTCCAAACCACTGCCCTGTGTTACATTCCCAGTAGCAATGTGTTCAGTTGCTTCACATCTTTCCCAACGCTTTTGATTTTCCTCTTTATTTTTCATTGAATCTAATCCTAGTGGGTATGAAGTATCTTACTGTGTTTTGATTTGCATTTCTCTAATGAATAATGATGTTGAGCATATTTTCATGTGCTTATGGGTCATTTGTAAACTTTTAGAGAAATGTCTGTTCCAATCTTTTATCCGTTTTAAAAATTGGATTGTCTTTTTGTTGTTGAGGTATAAGATTTCTTTCTATGTTCTAGATATTAGATGCTTAACAGATAAGCAGGAGAATCGCCTGAACCCGGGAGGCAGAGGCTGCAGTGAGCGGAGATTGTACCGCTGCCCTCCAGCCTGGGCGACAGAGGAGGGAGACTGTCTGAAACAAACAACAACAACAACAACAAGATGAAAATAATACGGCAAATACTGTTCTTGACTTTTACTGTATCGAGTGAGAACTGTAAGGCTTAGAACAGCATGTGGTGGACTGTAATGATTCTATTTGTTTGCTTCTTATCCCTTTGCTTCACCCAGAAAAGGATTATAGCAGTCTTTGTGACAAGCAACCGATAGGAAGACGTCTCTTCAGGCAGTTCTGTGATACCAAACCCACTCTAAAGAGGCACATTGAATTCTTGGATGCAGTGGTGAGCAGTTTATCTCCATATTGAGCAACCACCCAATCTTATGCTTTTGAAAATGTAAAAACTTGGCCAGGCGCAGTAGCTCATGCTGTAATCCCAGCATTTTGGAAGGCTGAGGCGGGCGGATCATGAGGTCAGGAGATCGAGACCATCCTGACCAACACAGTGAAACCCGTCTCTACTAAAATACAAAAAGTTAGCCGGGCGTGGTGGCGCGTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGGGAATCACTTGAACCAGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCACCACTGCCTTCCAGCCTGGGCGACAGAGCAAGACTCCGTCTCAAAAAAAAAGAAAATGTAAAAACTAGACCTGGGCAATGATGTAGGAGTGGAGGGACTGGTTGTCTTGGTGTCATATTATCTTATTAGGACAGAAATCCCTTTAGTCTGAAGTGGTATTTTGTGTAGAATTACGTCTCAAGTGTTGGAGAATCACATGTAGTCATTGAATGACTTTGAAACTTGAGGCTTGAATTGTATGAAGATGACAAACTAATTAAGATGATAATGCTTTTTTTATTTTTTATTTTTTTGAAATGGAGTCTCTCTCTGTCTCCCAGGCTGGACTGCAGTGGCATGATCTTGGCTTACTGCAACCTCCGCCTCCTGGGTTCAAGCAATTCTTCTGCCTCAGCCTTGTGATCCACCTGCCTTGGCCCCCCAAAGTGCTGGGATTACAGGCATAAGCCACTGTGCCCGGCTCTAAGATGATAGTGCTTGTTCGGCTACCAGAAAAGTGTC"
size<-30
type<-c("G","C")
AA<-GC_plot(seq,size,type)
GC_plot <- function(seq,size,type) {
library(Biostrings)
library(ggplot2)
seq <- DNAString(seq)
GC <-rowSums(letterFrequencyInSlidingView(seq, size, type)) / size
GC.data <- data.frame(x = c(1:(nchar(seq) - (size-1))), y = GC)
p <-
ggplot(data = GC.data, aes(x = x, y = y)) + geom_line(color = "red") + theme_bw() +
theme(panel.grid = element_blank())+theme(plot.margin=unit(rep(3,4),'lines'))
p<- p + xlab("Sequence 1") + ylab("Sequence 2")+ theme(axis.text.x = element_text(size=12,color = "black"),axis.text.y = element_text(size=12,color = "black"))+
scale_x_continuous(n.breaks=8)
png(file = paste0(filepath,"//","GC content.png"),width = 480*2,height = 480*2,res = 72*2)
print(p)
dev.off()
Full_length<-length(seq)
A_count<-letterFrequency(seq,"A")
A_percent<-paste0(round(A_count/Full_length*100,2),"%")
T_count<-letterFrequency(seq,"T")
T_percent<-paste0(round(T_count/Full_length*100,2),"%")
G_count<-letterFrequency(seq,"G")
G_percent<-paste0(round(G_count/Full_length*100,2),"%")
C_count<-letterFrequency(seq,"C")
C_percent<-paste0(round(C_count/Full_length*100,2),"%")
Count<-data.frame(A=A_count,T=T_count,G=G_count,C=C_count)
return(Count)
}
seq<-"TTACTTGGGTGTGGAGGCATGTGCCTATAATCCAAGGTACTCAGGAGGCTGAGGCATGAGAATTGCTTGAACCCGGGAGGTAGAGGTTGCAGTGAGCTGAGATTATGCCACTGCACTCCAGCCTGGATGACAGAGTGAGGCTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAGAAGTAGAATCATATGGTAATTCTGTGTTTAACTTTTTGAGGAACGCCAGACTCTTCCAAACCACTGCCCTGTGTTACATTCCCAGTAGCAATGTGTTCAGTTGCTTCACATCTTTCCCAACGCTTTTGATTTTCCTCTTTATTTTTCATTGAATCTAATCCTAGTGGGTATGAAGTATCTTACTGTGTTTTGATTTGCATTTCTCTAATGAATAATGATGTTGAGCATATTTTCATGTGCTTATGGGTCATTTGTAAACTTTTAGAGAAATGTCTGTTCCAATCTTTTATCCGTTTTAAAAATTGGATTGTCTTTTTGTTGTTGAGGTATAAGATTTCTTTCTATGTTCTAGATATTAGATGCTTAACAGATAAGCAGGAGAATCGCCTGAACCCGGGAGGCAGAGGCTGCAGTGAGCGGAGATTGTACCGCTGCCCTCCAGCCTGGGCGACAGAGGAGGGAGACTGTCTGAAACAAACAACAACAACAACAACAAGATGAAAATAATACGGCAAATACTGTTCTTGACTTTTACTGTATCGAGTGAGAACTGTAAGGCTTAGAACAGCATGTGGTGGACTGTAATGATTCTATTTGTTTGCTTCTTATCCCTTTGCTTCACCCAGAAAAGGATTATAGCAGTCTTTGTGACAAGCAACCGATAGGAAGACGTCTCTTCAGGCAGTTCTGTGATACCAAACCCACTCTAAAGAGGCACATTGAATTCTTGGATGCAGTGGTGAGCAGTTTATCTCCATATTGAGCAACCACCCAATCTTATGCTTTTGAAAATGTAAAAACTTGGCCAGGCGCAGTAGCTCATGCTGTAATCCCAGCATTTTGGAAGGCTGAGGCGGGCGGATCATGAGGTCAGGAGATCGAGACCATCCTGACCAACACAGTGAAACCCGTCTCTACTAAAATACAAAAAGTTAGCCGGGCGTGGTGGCGCGTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGGGAATCACTTGAACCAGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCACCACTGCCTTCCAGCCTGGGCGACAGAGCAAGACTCCGTCTCAAAAAAAAAGAAAATGTAAAAACTAGACCTGGGCAATGATGTAGGAGTGGAGGGACTGGTTGTCTTGGTGTCATATTATCTTATTAGGACAGAAATCCCTTTAGTCTGAAGTGGTATTTTGTGTAGAATTACGTCTCAAGTGTTGGAGAATCACATGTAGTCATTGAATGACTTTGAAACTTGAGGCTTGAATTGTATGAAGATGACAAACTAATTAAGATGATAATGCTTTTTTTATTTTTTATTTTTTTGAAATGGAGTCTCTCTCTGTCTCCCAGGCTGGACTGCAGTGGCATGATCTTGGCTTACTGCAACCTCCGCCTCCTGGGTTCAAGCAATTCTTCTGCCTCAGCCTTGTGATCCACCTGCCTTGGCCCCCCAAAGTGCTGGGATTACAGGCATAAGCCACTGTGCCCGGCTCTAAGATGATAGTGCTTGTTCGGCTACCAGAAAAGTGTC"
size<-30
type<-c("G","C")
AA<-GC_plot(seq,size,type)
GC_plot <- function(seq,size,type) {
library(Biostrings)
library(ggplot2)
seq <- DNAString(seq)
GC <-rowSums(letterFrequencyInSlidingView(seq, size, type)) / size
GC.data <- data.frame(x = c(1:(nchar(seq) - (size-1))), y = GC)
p <-
ggplot(data = GC.data, aes(x = x, y = y)) + geom_line(color = "red") + theme_bw() +
theme(panel.grid = element_blank())+theme(plot.margin=unit(rep(3,4),'lines'))
p<- p + xlab("Sequence 1") + ylab("Sequence 2")+ theme(axis.text.x = element_text(size=12,color = "black"),axis.text.y = element_text(size=12,color = "black"))+
scale_x_continuous(n.breaks=8)
png(file = paste0(filepath,"//","GC content.png"),width = 480*3,height = 480*2,res = 72*2)
print(p)
dev.off()
Full_length<-length(seq)
A_count<-letterFrequency(seq,"A")
A_percent<-paste0(round(A_count/Full_length*100,2),"%")
T_count<-letterFrequency(seq,"T")
T_percent<-paste0(round(T_count/Full_length*100,2),"%")
G_count<-letterFrequency(seq,"G")
G_percent<-paste0(round(G_count/Full_length*100,2),"%")
C_count<-letterFrequency(seq,"C")
C_percent<-paste0(round(C_count/Full_length*100,2),"%")
Count<-data.frame(A=A_count,T=T_count,G=G_count,C=C_count)
return(Count)
}
seq<-"TTACTTGGGTGTGGAGGCATGTGCCTATAATCCAAGGTACTCAGGAGGCTGAGGCATGAGAATTGCTTGAACCCGGGAGGTAGAGGTTGCAGTGAGCTGAGATTATGCCACTGCACTCCAGCCTGGATGACAGAGTGAGGCTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAGAAGTAGAATCATATGGTAATTCTGTGTTTAACTTTTTGAGGAACGCCAGACTCTTCCAAACCACTGCCCTGTGTTACATTCCCAGTAGCAATGTGTTCAGTTGCTTCACATCTTTCCCAACGCTTTTGATTTTCCTCTTTATTTTTCATTGAATCTAATCCTAGTGGGTATGAAGTATCTTACTGTGTTTTGATTTGCATTTCTCTAATGAATAATGATGTTGAGCATATTTTCATGTGCTTATGGGTCATTTGTAAACTTTTAGAGAAATGTCTGTTCCAATCTTTTATCCGTTTTAAAAATTGGATTGTCTTTTTGTTGTTGAGGTATAAGATTTCTTTCTATGTTCTAGATATTAGATGCTTAACAGATAAGCAGGAGAATCGCCTGAACCCGGGAGGCAGAGGCTGCAGTGAGCGGAGATTGTACCGCTGCCCTCCAGCCTGGGCGACAGAGGAGGGAGACTGTCTGAAACAAACAACAACAACAACAACAAGATGAAAATAATACGGCAAATACTGTTCTTGACTTTTACTGTATCGAGTGAGAACTGTAAGGCTTAGAACAGCATGTGGTGGACTGTAATGATTCTATTTGTTTGCTTCTTATCCCTTTGCTTCACCCAGAAAAGGATTATAGCAGTCTTTGTGACAAGCAACCGATAGGAAGACGTCTCTTCAGGCAGTTCTGTGATACCAAACCCACTCTAAAGAGGCACATTGAATTCTTGGATGCAGTGGTGAGCAGTTTATCTCCATATTGAGCAACCACCCAATCTTATGCTTTTGAAAATGTAAAAACTTGGCCAGGCGCAGTAGCTCATGCTGTAATCCCAGCATTTTGGAAGGCTGAGGCGGGCGGATCATGAGGTCAGGAGATCGAGACCATCCTGACCAACACAGTGAAACCCGTCTCTACTAAAATACAAAAAGTTAGCCGGGCGTGGTGGCGCGTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGGGAATCACTTGAACCAGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCACCACTGCCTTCCAGCCTGGGCGACAGAGCAAGACTCCGTCTCAAAAAAAAAGAAAATGTAAAAACTAGACCTGGGCAATGATGTAGGAGTGGAGGGACTGGTTGTCTTGGTGTCATATTATCTTATTAGGACAGAAATCCCTTTAGTCTGAAGTGGTATTTTGTGTAGAATTACGTCTCAAGTGTTGGAGAATCACATGTAGTCATTGAATGACTTTGAAACTTGAGGCTTGAATTGTATGAAGATGACAAACTAATTAAGATGATAATGCTTTTTTTATTTTTTATTTTTTTGAAATGGAGTCTCTCTCTGTCTCCCAGGCTGGACTGCAGTGGCATGATCTTGGCTTACTGCAACCTCCGCCTCCTGGGTTCAAGCAATTCTTCTGCCTCAGCCTTGTGATCCACCTGCCTTGGCCCCCCAAAGTGCTGGGATTACAGGCATAAGCCACTGTGCCCGGCTCTAAGATGATAGTGCTTGTTCGGCTACCAGAAAAGTGTC"
size<-30
type<-c("G","C")
AA<-GC_plot(seq,size,type)
type<-c("GC")
type
split(type,"")
split(type,",")
strsplit(type)
strsplit(type,"")
GC_plot <- function(seq,size,type) {
library(Biostrings)
library(ggplot2)
seq <- DNAString(seq)
type<-strsplit(type,"")
GC <-rowSums(letterFrequencyInSlidingView(seq, size, type)) / size
GC.data <- data.frame(x = c(1:(nchar(seq) - (size-1))), y = GC)
p <-
ggplot(data = GC.data, aes(x = x, y = y)) + geom_line(color = "red") + theme_bw() +
theme(panel.grid = element_blank())+theme(plot.margin=unit(rep(3,4),'lines'))
p<- p + xlab("Sequence 1") + ylab("Sequence 2")+ theme(axis.text.x = element_text(size=12,color = "black"),axis.text.y = element_text(size=12,color = "black"))+
scale_x_continuous(n.breaks=8)
png(file = paste0(filepath,"//","GC content.png"),width = 480*3,height = 480*2,res = 72*2)
print(p)
dev.off()
Full_length<-length(seq)
A_count<-letterFrequency(seq,"A")
A_percent<-paste0(round(A_count/Full_length*100,2),"%")
T_count<-letterFrequency(seq,"T")
T_percent<-paste0(round(T_count/Full_length*100,2),"%")
G_count<-letterFrequency(seq,"G")
G_percent<-paste0(round(G_count/Full_length*100,2),"%")
C_count<-letterFrequency(seq,"C")
C_percent<-paste0(round(C_count/Full_length*100,2),"%")
Count<-data.frame(A=A_count,T=T_count,G=G_count,C=C_count)
return(Count)
}
seq<-"TTACTTGGGTGTGGAGGCATGTGCCTATAATCCAAGGTACTCAGGAGGCTGAGGCATGAGAATTGCTTGAACCCGGGAGGTAGAGGTTGCAGTGAGCTGAGATTATGCCACTGCACTCCAGCCTGGATGACAGAGTGAGGCTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAGAAGTAGAATCATATGGTAATTCTGTGTTTAACTTTTTGAGGAACGCCAGACTCTTCCAAACCACTGCCCTGTGTTACATTCCCAGTAGCAATGTGTTCAGTTGCTTCACATCTTTCCCAACGCTTTTGATTTTCCTCTTTATTTTTCATTGAATCTAATCCTAGTGGGTATGAAGTATCTTACTGTGTTTTGATTTGCATTTCTCTAATGAATAATGATGTTGAGCATATTTTCATGTGCTTATGGGTCATTTGTAAACTTTTAGAGAAATGTCTGTTCCAATCTTTTATCCGTTTTAAAAATTGGATTGTCTTTTTGTTGTTGAGGTATAAGATTTCTTTCTATGTTCTAGATATTAGATGCTTAACAGATAAGCAGGAGAATCGCCTGAACCCGGGAGGCAGAGGCTGCAGTGAGCGGAGATTGTACCGCTGCCCTCCAGCCTGGGCGACAGAGGAGGGAGACTGTCTGAAACAAACAACAACAACAACAACAAGATGAAAATAATACGGCAAATACTGTTCTTGACTTTTACTGTATCGAGTGAGAACTGTAAGGCTTAGAACAGCATGTGGTGGACTGTAATGATTCTATTTGTTTGCTTCTTATCCCTTTGCTTCACCCAGAAAAGGATTATAGCAGTCTTTGTGACAAGCAACCGATAGGAAGACGTCTCTTCAGGCAGTTCTGTGATACCAAACCCACTCTAAAGAGGCACATTGAATTCTTGGATGCAGTGGTGAGCAGTTTATCTCCATATTGAGCAACCACCCAATCTTATGCTTTTGAAAATGTAAAAACTTGGCCAGGCGCAGTAGCTCATGCTGTAATCCCAGCATTTTGGAAGGCTGAGGCGGGCGGATCATGAGGTCAGGAGATCGAGACCATCCTGACCAACACAGTGAAACCCGTCTCTACTAAAATACAAAAAGTTAGCCGGGCGTGGTGGCGCGTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGGGAATCACTTGAACCAGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCACCACTGCCTTCCAGCCTGGGCGACAGAGCAAGACTCCGTCTCAAAAAAAAAGAAAATGTAAAAACTAGACCTGGGCAATGATGTAGGAGTGGAGGGACTGGTTGTCTTGGTGTCATATTATCTTATTAGGACAGAAATCCCTTTAGTCTGAAGTGGTATTTTGTGTAGAATTACGTCTCAAGTGTTGGAGAATCACATGTAGTCATTGAATGACTTTGAAACTTGAGGCTTGAATTGTATGAAGATGACAAACTAATTAAGATGATAATGCTTTTTTTATTTTTTATTTTTTTGAAATGGAGTCTCTCTCTGTCTCCCAGGCTGGACTGCAGTGGCATGATCTTGGCTTACTGCAACCTCCGCCTCCTGGGTTCAAGCAATTCTTCTGCCTCAGCCTTGTGATCCACCTGCCTTGGCCCCCCAAAGTGCTGGGATTACAGGCATAAGCCACTGTGCCCGGCTCTAAGATGATAGTGCTTGTTCGGCTACCAGAAAAGTGTC"
size<-30
type<-c("GC")
AA<-GC_plot(seq,size,type)
type
strsplit(type,"")
strsplit(type,"")[1]
strsplit(type,"")[[1]]
GC_plot <- function(seq,size,type) {
library(Biostrings)
library(ggplot2)
seq <- DNAString(seq)
type<-strsplit(type,"")[[1]]
GC <-rowSums(letterFrequencyInSlidingView(seq, size, type)) / size
GC.data <- data.frame(x = c(1:(nchar(seq) - (size-1))), y = GC)
p <-
ggplot(data = GC.data, aes(x = x, y = y)) + geom_line(color = "red") + theme_bw() +
theme(panel.grid = element_blank())+theme(plot.margin=unit(rep(3,4),'lines'))
p<- p + xlab("Sequence 1") + ylab("Sequence 2")+ theme(axis.text.x = element_text(size=12,color = "black"),axis.text.y = element_text(size=12,color = "black"))+
scale_x_continuous(n.breaks=8)
png(file = paste0(filepath,"//","GC content.png"),width = 480*3,height = 480*2,res = 72*2)
print(p)
dev.off()
Full_length<-length(seq)
A_count<-letterFrequency(seq,"A")
A_percent<-paste0(round(A_count/Full_length*100,2),"%")
T_count<-letterFrequency(seq,"T")
T_percent<-paste0(round(T_count/Full_length*100,2),"%")
G_count<-letterFrequency(seq,"G")
G_percent<-paste0(round(G_count/Full_length*100,2),"%")
C_count<-letterFrequency(seq,"C")
C_percent<-paste0(round(C_count/Full_length*100,2),"%")
Count<-data.frame(A=A_count,T=T_count,G=G_count,C=C_count)
return(Count)
}
seq<-"TTACTTGGGTGTGGAGGCATGTGCCTATAATCCAAGGTACTCAGGAGGCTGAGGCATGAGAATTGCTTGAACCCGGGAGGTAGAGGTTGCAGTGAGCTGAGATTATGCCACTGCACTCCAGCCTGGATGACAGAGTGAGGCTCTGTCTCAAAAAAAAAAAAAAAAAAAAAAAAGAAGTAGAATCATATGGTAATTCTGTGTTTAACTTTTTGAGGAACGCCAGACTCTTCCAAACCACTGCCCTGTGTTACATTCCCAGTAGCAATGTGTTCAGTTGCTTCACATCTTTCCCAACGCTTTTGATTTTCCTCTTTATTTTTCATTGAATCTAATCCTAGTGGGTATGAAGTATCTTACTGTGTTTTGATTTGCATTTCTCTAATGAATAATGATGTTGAGCATATTTTCATGTGCTTATGGGTCATTTGTAAACTTTTAGAGAAATGTCTGTTCCAATCTTTTATCCGTTTTAAAAATTGGATTGTCTTTTTGTTGTTGAGGTATAAGATTTCTTTCTATGTTCTAGATATTAGATGCTTAACAGATAAGCAGGAGAATCGCCTGAACCCGGGAGGCAGAGGCTGCAGTGAGCGGAGATTGTACCGCTGCCCTCCAGCCTGGGCGACAGAGGAGGGAGACTGTCTGAAACAAACAACAACAACAACAACAAGATGAAAATAATACGGCAAATACTGTTCTTGACTTTTACTGTATCGAGTGAGAACTGTAAGGCTTAGAACAGCATGTGGTGGACTGTAATGATTCTATTTGTTTGCTTCTTATCCCTTTGCTTCACCCAGAAAAGGATTATAGCAGTCTTTGTGACAAGCAACCGATAGGAAGACGTCTCTTCAGGCAGTTCTGTGATACCAAACCCACTCTAAAGAGGCACATTGAATTCTTGGATGCAGTGGTGAGCAGTTTATCTCCATATTGAGCAACCACCCAATCTTATGCTTTTGAAAATGTAAAAACTTGGCCAGGCGCAGTAGCTCATGCTGTAATCCCAGCATTTTGGAAGGCTGAGGCGGGCGGATCATGAGGTCAGGAGATCGAGACCATCCTGACCAACACAGTGAAACCCGTCTCTACTAAAATACAAAAAGTTAGCCGGGCGTGGTGGCGCGTGCCTGTAGTCCCAGCTACTTGGGAGGCTGAGGCAGGGGAATCACTTGAACCAGGAGGCGGAGGTTGCAGTGAGCCGAGATCGCACCACTGCCTTCCAGCCTGGGCGACAGAGCAAGACTCCGTCTCAAAAAAAAAGAAAATGTAAAAACTAGACCTGGGCAATGATGTAGGAGTGGAGGGACTGGTTGTCTTGGTGTCATATTATCTTATTAGGACAGAAATCCCTTTAGTCTGAAGTGGTATTTTGTGTAGAATTACGTCTCAAGTGTTGGAGAATCACATGTAGTCATTGAATGACTTTGAAACTTGAGGCTTGAATTGTATGAAGATGACAAACTAATTAAGATGATAATGCTTTTTTTATTTTTTATTTTTTTGAAATGGAGTCTCTCTCTGTCTCCCAGGCTGGACTGCAGTGGCATGATCTTGGCTTACTGCAACCTCCGCCTCCTGGGTTCAAGCAATTCTTCTGCCTCAGCCTTGTGATCCACCTGCCTTGGCCCCCCAAAGTGCTGGGATTACAGGCATAAGCCACTGTGCCCGGCTCTAAGATGATAGTGCTTGTTCGGCTACCAGAAAAGTGTC"
size<-30
type<-c("GC")
AA<-GC_plot(seq,size,type)
AA
Mydata<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2)
filepath<-"C://Users//41518//Desktop//work/ubigene"
library(openxlsx)
library(Biostrings)
Mydata<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2)
Mydata
Mydata
Mydata$载体类型<-type
Mydata
type="双gRNA"
Mydata$载体类型<-type
Mydata
for (i in 1:nrow(Mydata)) {
if(is.na(Mydata[i,]$骨架信息)){
Mydata[i,]$骨架信息<-Mydata[i-1,]$骨架信息
Mydata[i,]$检菌引物<-Mydata[i-1,]$检菌引物
Mydata[i,]$测序引物<-Mydata[i-1,]$测序引物
Mydata[i,]$酶切方案<-Mydata[i-1,]$酶切方案
}
}
Mydata
View(Mydata)
read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,colNames = TRUE,rowNames = TRUE)
a<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,colNames = TRUE,rowNames = TRUE)
a<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,colNames = TRUE)
a
a<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,fillMergedCells=TRUE)
a
Mydata<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,fillMergedCells=TRUE)
rm(a)
View(Mydata)
Mydata$载体类型
Mydata$F引物
Mydata<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,fillMergedCells=TRUE,colNames = FALSE)
View(Mydata)
Mydata$x2
View(Mydata)
Mydata$X2
View(Mydata)
mergeCells(Mydata,)
class(Mydata)
wb <- createWorkbook()
class(sb)
class(wb)
Mydata2<-Mydata[which(Mydata$X2==scaffoldname),]
scaffoldname = "YKO-RP005"
genename = "Cd44 "
gRNA1 ="AATGTAACCTGCCGCTACGC"
gRNA2 ="CAACTTCATTTGGTCCATGG"
Mydata2<-Mydata[which(Mydata$X2==scaffoldname),]
View(Mydata2)
mergeCells(Mydata2,cols = 1,rows = 2:3)
addWorksheet(wb, "Sheet 1")
wb
view(wb)
writeData(wb,"1",Mydata2)
writeData(wb,"Sheet 1",Mydata2)
wb
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
Mydata2
Mydata
Mydata<-read.xlsx(paste0(filepath,"//carrier.xlsx"),sheet=2,fillMergedCells=TRUE)
Mydata2<-Mydata[which(Mydata$X2==scaffoldname),]
View(Mydata)
Mydata2<-Mydata[which(Mydata[,2]==scaffoldname),]
View(Mydata2)
View(Mydata2)
Mydata2[,4] <- c(paste0(genename,"[gRNA",number,"]-F1"),paste0(genename,"[gRNA1",number,"]-F2"))
Mydata2[,6] <- c(paste0(genename,"[gRNA2",number,"]-R1"),paste0(genename,"[gRNA2",number,"]-R2"))
number=1
Mydata2[,4] <- c(paste0(genename,"[gRNA",number,"]-F1"),paste0(genename,"[gRNA1",number,"]-F2"))
Mydata2[,6] <- c(paste0(genename,"[gRNA2",number,"]-R1"),paste0(genename,"[gRNA2",number,"]-R2"))
Mydata2[1,5] <- paste0("g",gRNA1,"GTTTTAGAGCTAGAAATAGCAAGTT")
Mydata2[2,5] <- paste0("TGTGGAAAGGACGAAACACC","g",gRNA1)
g <- as.character(reverseComplement(DNAString(gRNA2)))
Mydata2[1,7] <- paste0(g,"c","GGTGTTTCGTCCTTTCCACAAG")
Mydata2[2,7] <- paste0("ACTTGCTATTTCTAGCTCTAAAAC",g)
Mydata2
View(Mydata2)
number1=5
number2=6
Mydata2[,4] <- c(paste0(genename,"[gRNA",number1,"]-F1"),paste0(genename,"[gRNA",number2,"]-F2"))
Mydata2[,6] <- c(paste0(genename,"[gRNA",number1,"]-R1"),paste0(genename,"[gRNA",number2,"]-R2"))
Mydata2[,4] <- c(paste0(genename,"[gRNA",number1,"]-F1"),paste0(genename,"[gRNA",number1,"]-F2"))
Mydata2[,6] <- c(paste0(genename,"[gRNA",number2,"]-R1"),paste0(genename,"[gRNA",number2,"]-R2"))
View(Mydata2)
wb <- createWorkbook()
addWorksheet(wb, "Sheet 1")
writeData(wb,"Sheet 1",Mydata2)
saveWorkbook(wb, "C://Users//41518//Desktop//work/mergeCellsExample.xlsx", overwrite = TRUE)
writeData(wb,"Sheet 1",Mydata2,colNames = FALSE)
saveWorkbook(wb, "C://Users//41518//Desktop//work/mergeCellsExample.xlsx", overwrite = TRUE,)
wb <- createWorkbook()
addWorksheet(wb, "Sheet 1")
writeData(wb,"Sheet 1",Mydata2,colNames = FALSE)
saveWorkbook(wb, "C://Users//41518//Desktop//work/mergeCellsExample.xlsx", overwrite = TRUE,)
saveWorkbook(wb, "C://Users//41518//Desktop//work/mergeCellsExample.xlsx", overwrite = TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
writeData(wb,"Sheet 1",Mydata2)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
setColWidths(wb,1,cols = 1:12, widths = "auto")
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
getCellRefs(Mydata2)
getCellRefs(wb)
getTables(wb)
getTables(wb,1)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
getTables(wb,1)
getStyles(wb)[1:3]
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
sheetVisible(wb)
sheetVisibility(wb)
wb
mergeCells(wb, 1, rows=1, cols =1:2)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
Style <- createStyle(fontSize = 13, halign = "center")
addStyle(wb,1,style = Style,rows=1:3,cols = 1:12)
addStyle(wb,1,style = Style,rows=1,cols = 1:12)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
addStyle(wb,1,style = Style,rows=3,cols = 1:12)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 1:2)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = c(1:2))
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = c(1:2))
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 3)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 2)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = c(1:2,10:12),gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "20")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = c(1:2,10:12),gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "20")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2,borders = "surrounding")
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2,borders = "all")
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
setwd("C://Users//41518//Desktop//work/ubigene/primer")
source("Get_ID.R")
source("Get_allinfo.R")
source("Get_seq.R")
term<-"SAMD8"
species<-"Human"
ID <- Get_ID(term,species)
library(httr)
library(jsonlite)
library(xml2)
ID <- Get_ID(term,species)
Gene <- Get_seq(ID)
allinfo <- Get_allinfo(ID)
start <- allinfo$start-1500

mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 1:2)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = c(1:2))
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = c(1:2))
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 3)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 13, halign = "center",valign = "center"),rows=2:3,cols = 2)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "auto")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = c(1:2,10:12),gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "20")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = c(1:2,10:12),gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "20")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2)
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2,borders = "surrounding")
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
wb <- createWorkbook()
addWorksheet(wb, 1)
writeData(wb,1,Mydata2,borders = "all")
mergeCells(wb, 1, rows=1, cols =1:2)
mergeCells(wb, 1, rows=1, cols =4:5)
mergeCells(wb, 1, rows=1, cols =6:7)
mergeCells(wb, 1, cols=1, rows =2:3)
mergeCells(wb, 1, cols=2, rows =2:3)
mergeCells(wb, 1, cols=10, rows =2:3)
mergeCells(wb, 1, cols=11, rows =2:3)
mergeCells(wb, 1, cols=12, rows =2:3)
setColWidths(wb,1,cols = 1:12, widths = "18")
setRowHeights(wb,1,rows = 1:3,heights = "22")
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=1,cols = 1:12)
addStyle(wb,1,style = createStyle(fontSize = 11, halign = "center",valign = "center"),rows=2:3,cols = 1:2,gridExpand=TRUE)
addStyle(wb,1,style = createStyle(fontSize = 11, valign = "center"),rows=2:3,cols = 10:12,gridExpand=TRUE)
saveWorkbook(wb, "C://Users//41518//Desktop//mergeCellsExample.xlsx", overwrite = TRUE)
library("dplyr")
library("rvest")
library("stringr")
library(httr)
library(jsonlite)
library(xml2)
gene.table<-read.csv("C://Users//41518//Desktop//3.csv")
i=4567
IMUFE_url<-paste0("https://www.ncbi.nlm.nih.gov/gene/?term=",gene.table[i,]$ID)
r<-RETRY("GET",IMUFE_url,encode = "UTF-8")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("maincontent]")
allSourceCode <- allSourceCode %>%
html_node("maincontent")
allSourceCode <- allSourceCode %>%
html_nodes("maincontent]")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes("maincontent]")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes("maincontent")
url <- paste0(
"https://web.archive.org/web/20190202054736/",
"https://www.boxofficemojo.com/movies/?id=ateam.htm"
)
ateam <- read_html(url)
html_nodes(ateam, "center")
ateam <- read_html(url)
View(ateam)
ateam <- read_html(url)
View(ateam)
allSourceCode <- allSourceCode %>%
html_nodes(xpath = "//maincontent")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes(xpath = "//maincontent")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes(xpath = "//grid")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes("grid")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_nodes("div[class=grid]")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("div[class=grid]")
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
allSourceCode <- allSourceCode %>%
html_node("div[class=content]")
allSourceCode <- allSourceCode %>%
html_node("div[class=rprt-body]")
allSourceCode<-read_html(IMUFE_url)
allSourceCode <- allSourceCode %>%
html_node("div[class=grid]")
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
View(allSourceCode)
allSourceCode
allSourceCode <- allSourceCode %>%
html_node("div[class=content]")
allSourceCode <- allSourceCode %>%
html_node("div[class=rprt-body]")
allSourceCode <- allSourceCode %>%
html_node("div[id=summaryDiv]")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("div[class=grid]")
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
allSourceCode <- allSourceCode %>%
html_node("div[class=content]")
IMUFE_text <- allSourceCode %>%
html_text(trim = TRUE)
IMUFE_text
IMUFE_url
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("div[class=grid]")
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
IMUFE_text <- allSourceCode %>%
html_text(trim = TRUE)
IMUFE_text
IMUFE_url<-paste0("https://www.ncbi.nlm.nih.gov/gene/",gene.table[i,]$ID)
r<-RETRY("GET",IMUFE_url,encode = "UTF-8")
allSourceCode<-content(r)
allSourceCode <- allSourceCode %>%
html_node("div[id=maincontent]")
allSourceCode <- allSourceCode %>%
html_node("div[class=content]")
allSourceCode <- allSourceCode %>%
html_node("div[class=rprt-body]")
allSourceCode <- allSourceCode %>%
html_node("div[id=summaryDiv]")
allSourceCode <- allSourceCode %>%
html_node("dl[id=summaryDl]")
IMUFE_text <- allSourceCode %>%
html_text(trim = TRUE)
summary<-str_split(IMUFE_text,"\\n\\s+")[[1]]
summary
setwd("C://Users//41518//Desktop//work//ubigene//carrier/")
AGTACGTACAGATTTTATTTc
seq<-'AGTACGTACAGATTTTATTTc'
GC_count<-0
seq
grep("G",seq)
gregexpr("G",seq)
gregexpr("C",seq)
gregexpr("C",seq)
gregexpr("c",seq)
length(gregexpr("C",seq))
length(gregexpr("C",seq)[[1]])
length(gregexpr("[GCgc]",seq)[[1]])
GC_count<-length(gregexpr("[GCgc]",seq)[[1]])
nchar(seq)
GC_count<-length(gregexpr("[GCgc]",seq)[[1]])
TM<-100.5 + (41*(GC_count)/nchar(seq)) - (820/nchar(seq)) + 16.6*log(0.05,10)
TM
GC_count
GC_count<-round(length(gregexpr("[GCgc]",seq)[[1]])/nchar(seq),2)
GC_count
TM<-100.5 + (41*(GC_count)/nchar(seq)) - (820/nchar(seq)) + 16.6*log(0.05,10)
TM
GC_count<-length(gregexpr("[GCgc]",seq)[[1]])
TM<-100.5 + (41*(GC_count)/nchar(seq)) - (820/nchar(seq)) + 16.6*log(0.05,10)
TM
seq<-"gGAGGCCCCTCCCTCGCTGTA"
TM(seq)
TM<-function(seq){
GC_count<-length(gregexpr("[GCgc]",seq)[[1]])
tm<-100.5 + (41*(GC_count)/nchar(seq)) - (820/nchar(seq)) + 16.6*log(0.05,10)
return(tm)
}
TM(seq)
seq
seq[1]
gRNA1<-seq
gRNA1[[1]]
i=1
g<-"AGTACGTACAGATTTTATTT"
seq2<-paste0(g,"c")
TM(seq1)
seq1<-paste0("g",gRNA1[[i]])
gRNA0
gRNA1
gRNA1<-"GAGGCCCCTCCCTCGCTGTA"
seq1<-paste0("g",gRNA1[[i]])
seq2<-paste0(g,"c")
TM(seq1)
nchar(seq1)
seq1
substring(seq1,1,nchar(seq1)-1)
seq1<-paste0("g",gRNA1[[i]],"gttttaga")
seq2<-paste0(g,"cggtgtttc")
nchar(seq2)
nchar(seq1)
m=n=21
TM(substring(seq1,1,m))
repeat{
if(TM(substring(seq1,1,m))>70){
m<-m-1
}
if(TM(substring(seq1,1,m))<60){
m<-m+1
}
if(TM(substring(seq1,1,n))>70){
n<-n-1
}
if(TM(substring(seq1,1,n))<60){
n<-n+1
}
}
m=n=21
repeat{
if(TM(substring(seq1,1,m))>70){
m<-m-1
}
if(TM(substring(seq1,1,m))<60){
m<-m+1
}
if(TM(substring(seq1,1,n))>70){
n<-n-1
}
if(TM(substring(seq1,1,n))<60){
n<-n+1
}
if(m==18 | n==18 | m==29 | n==29){
break
}
}
TM(substring(seq1,1,m))
while(TM(substring(seq1,1,m))>70){
m<-m-1
if(m==18){
break
}
}
while(TM(substring(seq1,1,m))<60){
m<-m+1
if(m==29){
break
}
}
while(TM(substring(seq1,1,m))>70){
m<-m-1
if(TM(substring(seq1,1,m))<=70|m==18){
break
}
}
TM(substring(seq1,1,n))
TM(substring(seq2,1,n))
while(TM(substring(seq2,1,n))>70){
n<-n-1
if(TM(substring(seq2,1,n))<=70|n==18){
break
}
}
while(TM(substring(seq2,1,n))<60){
n<-n+1
if(TM(substring(seq2,1,n))>=60|n==29){
break
}
}
n
substring(seq2,1,n)
TM(substring(seq1,1,m))-TM(substring(seq2,1,n))
TM(substring(seq1,1,m))-TM(substring(seq2,1,n))>6
TM(substring(seq1,1,m))-TM(substring(seq2,1,n))
while(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))>6){
if(n<29){
n<-n+1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
if(m>18){
m<-m-1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
}
TM(substring(seq1,1,m)
)
substring(seq1,1,m)
substring(seq2,1,n)
TM(substring(seq2,1,n)-TM(substring(seq1,1,m)))
TM(substring(seq2,1,n))-TM(substring(seq1,1,m))
TM(substring(seq2,1,n))-TM(substring(seq1,1,m))>6
paste0("TGTGGAAAGGACGAAACACC",substring(seq1,1,m))
paste0("GCTATTTCTAGCTCTAAAAC",substring(seq2,1,n))
gRNA1='GGGGGGGGGGGGGGGGGGGG'
seq1<-paste0("g",gRNA1[[i]],"gttttaga")
seq2<-paste0(g,"cggtgtttc")
m=n=21
while(TM(substring(seq1,1,m))>70){
m<-m-1
if(TM(substring(seq1,1,m))<=70|m==18){
break
}
}
while(TM(substring(seq1,1,m))<60){
m<-m+1
if(TM(substring(seq1,1,m))>=60|m==29){
break
}
}
while(TM(substring(seq2,1,n))>70){
n<-n-1
if(TM(substring(seq2,1,n))<=70|n==18){
break
}
}
while(TM(substring(seq2,1,n))<60){
n<-n+1
if(TM(substring(seq2,1,n))>=60|n==29){
break
}
}
m
TM(substring(seq1,1,m))-TM(substring(seq2,1,n))
while(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))>6){
if(n<29){
n<-n+1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
if(m>18){
m<-m-1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
}
seq1<-paste0("g",gRNA1[[i]],"gttttaga")
seq2<-paste0(g,"cggtgtttc")
m=n=21
while(TM(substring(seq1,1,m))>70){
m<-m-1
if(TM(substring(seq1,1,m))<=70|m==18){
break
}
}
while(TM(substring(seq1,1,m))<60){
m<-m+1
if(TM(substring(seq1,1,m))>=60|m==29){
break
}
}
while(TM(substring(seq2,1,n))>70){
n<-n-1
if(TM(substring(seq2,1,n))<=70|n==18){
break
}
}
while(TM(substring(seq2,1,n))<60){
n<-n+1
if(TM(substring(seq2,1,n))>=60|n==29){
break
}
}
while(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))>6){
if(n<29){
n<-n+1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
if(m>18){
m<-m-1
if(TM(substring(seq1,1,m))-TM(substring(seq2,1,n))<=6){
break
}
}
if(n==29&m==18){
break
}
}
substring(seq1,1,m)
substring(seq2,1,n)

alignment<-function(seq1,seq2,type){
  library(Biostrings)
  if(type=="DNA"){
    mat<-nucleotideSubstitutionMatrix(match = 2, mismatch = 3, baseOnly = TRUE, type = "DNA")
    pwa <- pairwiseAlignment(seq1,seq2, substitutionMatrix = mat,gapOpening = 5, gapExtension =2)
  }
  
  if(type=="Protein"){
    pwa<-pairwiseAlignment(seq1, seq2, substitutionMatrix = "BLOSUM62", gapOpening = 11, gapExtension = 1)
  }
  
  seq1_aligned<-as.character(alignedPattern(pwa))
  seq2_aligned<-as.character(alignedSubject(pwa))
  
  Query<-strsplit(seq1_aligned,"")[[1]]
  Sbjct<-strsplit(seq2_aligned,"")[[1]]
  Identities<-0
  for(i in 1:length(Query)){
    if(Query[i]==Sbjct[i]){
      Identities=Identities+1
    }
  }
  
  Gaps<-0
  for(i in 1:length(Query)){
    if(Query[i]=="-"| Sbjct[i]=="-"){
      Gaps=Gaps+1
    }
  }
  result<-list(seq1=seq1_aligned,seq2=seq2_aligned,length1=nchar(seq1),length2=nchar(seq2),length_aligned=length(Query),Identities=Identities,Identities_pec=round(Identities/length(Query)*100,2),Gaps=Gaps,Gaps_pec=round(Gaps/length(Query)*100,2),score=score(pwa))
  return(result)
}
# 
# seq1<-"TTTTGAAATTTGACTGTAAACACAAAGATATTAGTACAAAATACGTGACGTAGAAAGTAATAATTTCTTGGGTAGTTTGCAGTTTTAAAATTATGTTTTAAAATGGACTATCATATGCTTACCGTAACTTGAAAGTATTTCGATTTCTTGGCTTTATATATCTTGTGGAAAGGACGAAACACCGCAACAGGGAGCCGAGTACGAGTTTTAGAGCTAGAAATAGCAAGTTAAAATAAGGCTAGTCCGTTATCAACTTGAAAAAGTGGCACCGAGTCGGTGCTTTTTTGAATTCGGGTTGCGCCTTTTCCAAGGCAGCCCTGGGTTTGCGCAGGGACGCGGCTGCTCTGGGCGTGGTTCCGGGAAACGCAGCGGCGCCGACCCTGGGTCTCGCACATTCTTCACGTCCGTTCGCAGCGTCACCCGGATCTTCGCCGCTACCCTTGTGGGCCCCCCGGCGACGCTTCCTGCTCCGCCCCTAAGTCGGGAAGGTTCCTTGCGGTTCGCGGCGTGCCGGACGTGACAAACGGAAGCCGCACGTCTCACTAGTACCCTCGCAGACGGACAGCGCCAGGGAGCAATGGCAGCGCGCCGACCGCGATGGGCTGTGGCCAATAGCGGCTGCTCAGCAGGGCGCGCCGAGAGCAGCGGCCGGGAAGGGGCGGTGCGGGAGGCGGGGTGTGGGGCGGTAGTGTGGGCCCTGTTCCTGCCCGCGCGGTGTTCCGCATTCTGCAAGCCTCCGGAGCGCACGTCGGCAGTCGGCTCCCTCGTTGACCGAATCACCGACCTCTCTCCCCAGGGGATCCGCCACCATGGTGAGCAAGGGCGAGGAGCTGTTCACCGGGGTGGTGCCCATCCTGGTCGAGCTGGACGGCGACGTAAACGGCCACAAGTTCAGCGTGTCCGGCGAGGGCGAGGGCGATGCCACCTACGGCAAGCTGACCCTGAAGTTCATCTGCACACCGGCAAGCTGCCCGTGCCTGGCCACCCTCGTGACACCCTGGACTACGGCGTGCAGTGCTTCACCGCTACCCCGACACATGAAGCAGCCGAATTCTTTAAGTCGCCATGCCCGAAGGTAC"
# seq2<-"TTTTGAAATTTGACTGTAAACACAAAGATATTAGTACAAAATACGTGACGTAGAAAGTAATAATTTCTTGGGTAGTTTGCAGTTTTAAAATTATGTTTTAAAATGGACTATCATATGCTTACCGTAACTTGAAAGTATTTCGATTTCTTGGCTTTATATATCTTGTGGAAAGGACGAAACACCGCAACAGGGAGCCGAGTACGAGTTTTAGAGCTAGAAATAGCAAGTTAAAATAAGGCTAGTCCGTTATCAACTTGAAAAAGTGGCACCGAGTCGGTGCTTTTTTGAATTCGGGTTGCGCCTTTTCCAAGGCAGCCCTGGGTTTGCGCAGGGACGCGGCTGCTCTGGGCGTGGTTCCGGGAAACGCAGCGGCGCCGACCCTGGGTCTCGCACATTCTTCACGTCCGTTCGCAGCGTCACCCGGATCTTCGCCGCTACCCTTGTGGGCCCCCCGGCGACGCTTCCTGCTCCGCCCCTAAGTCGGGAAGGTTCCTTGCGGTTCGCGGCGTGCCGGACGTGACAAACGGAAGCCGCACGTCTCACTAGTACCCTCGCAGACGGACAGCGCCAGGGAGCAATGGCAGCGCGCCGACCGCGATGGGCTGTGGCCAATAGCGGCTGCTCAGCAGGGCGCGCCGAGAGCAGCGGCCGGGAAGGGGCGGTGCGGGAGGCGGGGTGTGGGGCGGTAGTGTGGGCCCTGTTCCTGCCCGCGCGGTGTTCCGCATTCTGCAAGCCTCCGGAGCGCACGTCGGCAGTCGGCTCCCTCGTTGACCGAATCACCGACCTCTCTCCCCAGGGGATCCGCCACCATGGTGAGCAAGGGCGAGGAGCTGTTCACCGGGGTGGTGCCCATCCTGGTCGAGCTGGACGGCGACGTAAACGGCCACAAGTTCAGCGTGTCCGGCGAGGGCGAAGGGCGATGCCACCTACGGCAAGCTGACCCTGAATTTCATCTGCACACCGGCAAGCTGCCCGTGCCTGGCCACCCTCGTGACCCCCTGACTACGGCGTGCAGTGCTTCACCGCTACCCGACCAATGAAACACCCAAATTCTTCAATCCGCCTGCCCAAGGT"
# type="DNA"
# aaa<-alignment(seq1,seq2,type)

# seq1<-"METTPTSTQARYVSQGCQKHTKLRHRPLQFVYDFKSGQHSVHSNTSLTSLFEESSLCSSLGEVDTSWFDSERWTSNDETKWKKEDILKTPQASQRENKACSTPGLFTPDGLSPVARRGHKDYPDCHPLPDDESASSFLRPKRFRKVPSSIHTTPNSQIITSHQPTSGPTAETIEEEEEEDKGEVAQSADIQFSPYPTWNPTFHKDTPVFMKQLFKTPSTLFGAGDKRACSTPLQRLSTPQRLSRSLGAEPEESDLSWTSSLATPPMSSKGCKTVTSSTKKVIEDDSWQTHDVAKVLFQDGGSVAEMDSCDEGDEGLTQPLQVIKLPSITDESQEEEFTIETEDGGESDKSIADGSKAIAALGNEQCSRFDVVGGATSPDNLKNDQDGTRTVMNNSLVPPTTSVQSSMTYHGKPHLAKDEEHESVGEYAVPDQYVDEKASVREKVEDMDNAAELKSRTIANGECTDTNVTSKLAHGSHSMKNHLHVPIQPTMSSQQSSIIGSSQTLFNSQESIKNEKSAIEETLAFLLATPPSRREKLLNRLGTSSSGIGETTSFEKAACDAAGSTLDGRSDSPVTSNSVPKKSTSDDTLMSPPVGILWKRSIPGHLSGGPERNSLESECSVDAKTNGQVGETPNRPAPDVDMLSPISPNFAEALCRVTDIASREQPSSNKSTLTVQKCLEVERNLVGDFDSPDPDTAVSHIKVVDQSTSEDHTDIVVKQSLHPTEITGENAIAGHLSAPITSSLPSSAKNKLPKHLSKQEPSPVVPPSRSLAVSNLNTQTTAKGRFKYTAAVPRKDGASTSKTPSWLSRAIYVEEDEEEDKTADAVQADTIKDESSKKPWIMKRPCRTATTFKTFSTFCKTAPNPPSSTQSQTGPRTSTTPTSSRSIVQSAPPHNKTLVRIREIPHSWPSPKRLRLDEEREECPIGNDLKSLSPAVDEHDGEITKSTPLESDVKSHHVQDVVSLHVEEGVEDQKDLGDFHDKVNSEDLVPSSEGDLHQMAPNVGFSSASGKAIFVSPEAL"
# seq2<-"GSVGTKNSAPGQIGFQTARGGAISVSDESLKKAKQLLEDDAQDGNVQKKREMKQTGVVSSPPMTGFQTGSGKCIHISNSAILKAKQLLSNDFDEYEDLPDVKTSSAPSHKHPGPVELEIGFQTGGGRRIQVLQSSLLQARHVICDEKDANQNVLKSESSGQRKKDNSEPVDMDSDESHETDALPDQNIVQGFQTGHGKKVHVSEASIQRAKQFLADENDGSPDQSVVLGFQTGRGKKVQVSAASLQEARHFLTDETAPLQDQNIAVGFQTGHGKKVQISEASLLKAKQFLAHENDPSPDQSVAIGFQTGHGKKVQISEASLQKAKQFLADDTDALPVKNIAVGFQTGHGKKVQISEASLQIAKQFLAHEKDAGTDALSKNSAVPGEANENPLSGEPSKMSGFMTGEGRKVQVSEASLQQARNSLGSQAIRNDIGGELSNGTLPHGVQQPTLTSRADGDHLTHQRKDSKEEFHQQERIRESSRGDGSLATPSNLPAPGGLAKKSMVDTRNRQSNQQRNKGTGSRGTGQKPYKPPRRVDDKGSTSAAGLIPRCSNPTVVLNDRTKQCKARQSSPPTSLSTSSHCVSDGSLHRAGPSVKSCPDQDATNQSQSQLEATPTIAEGGCSFVARWAEARRAQQQRIDAKRKKVIKPELGSLWRSRKEQDRISLGEFVNHQYPCSMSDSELFGHGILSSTLSVRPSNAEGYEFAGEDHFSPSCLESDRGIPLDDGGRLVLSPNGLAGKKEFYSALLDTPGVDPKLLKEEWVFNHYKWIIWKAAAMEVAYPLQLGGRFLTPNWVLLQLKYRYDREIDHSQRPALRKILERDDAASRRMVLCVAAIGNTGSSAGHDGKGAEQRKSLQAVSHPTLELTDGWYSIPAAIDPPLANHVRSGRIVCGTKLCISGAELVGAQDACSPLEIPEGLKLKITANSTRRARYDARLGLQADPRPFPLPMTSLHPEGGTIGCLDVLILRTYPMQFMEKLPEGGSVFRNAKEEAKAAA"
# type="Protein"
# aaa<-alignment(seq1,seq2,type)
